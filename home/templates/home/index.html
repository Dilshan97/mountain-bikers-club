{% extends 'home/base.html' %}
{% load static i18n tpl_button tpl_trail_preview %}

{% block title %}{% trans 'Home' %}{% endblock %}
{% block description %}{% trans 'For the love of mountain biking and wild nature' %}{% endblock %}

{% block headerlinks %}
    <li class="has-hidden-links">
        {% if user.is_authenticated %}
            <a href="{% url 'dashboard' %}">
                {% filter lower %}
                    {% blocktrans with user=user.username %}{{ user }}'s dashboard{% endblocktrans %}
                {% endfilter %}
            </a>
        {% else %}
            <a href="{% url 'login' %}">{% trans 'Sign in'|lower %}</a>
        {% endif %}
    </li>
{% endblock %}

{% block content %}
    <div class="o-section">
        <div class="o-group is-large">
            <div class="o-flex-inline has-gutter">
                <div class="cell-2of3">
                    <h1>{% trans 'For the love of mountain biking and wild nature' %}.</h1>
                    <p>
                        {% if user.is_authenticated %}{% trans 'Welcome back' %},
                            {% else %}{% trans 'Hello' %},
                        {% endif %}
                        {{ user.first_name|default:user.username|default:'mountain biker' }}. ðŸ‘‹
                    </p>
                    {% if user.is_authenticated %}
                        <div class="o-flex-inline has-gutter">
                            <div>
                                {% trans 'Go to your dashboard' as button_label %}
                                {% url 'dashboard' as button_link %}
                                {% tpl_button button_label button_link %}
                            </div>
                            <div>
                                {% trans 'Logout' as button_label %}
                                {% url 'logout' as button_link %}
                                {% tpl_button button_label button_link class='is-secondary' %}
                            </div>
                        </div>
                    {% else %}
                        <div class="o-flex-inline has-gutter">
                            <div>
                                {% trans 'Sign in' as button_label %}
                                {% url 'login' as button_link %}
                                {% tpl_button button_label button_link %}
                            </div>
                            <div>
                                {% trans 'Create an account' as button_label %}
                                {% url 'register' as button_link %}
                                {% tpl_button button_label button_link class='is-warning' %}
                            </div>
                        </div>
                    {% endif %}
                    <p><!-- empty --></p>
                    {% blocktrans trimmed %}
                        This is the multiline welcome message
                    {% endblocktrans %}
                </div>
                <div class="cell-1of3">
                    {% if not user.is_authenticated %}
                        <h2>{% trans 'Create an account' %}</h2>
                        <form method="post" action="{% url 'register' %}">
                            {% csrf_token %}
                            <ul class="django__form">
                                {{ form_register.as_ul }}
                            </ul>
                            {% trans 'Sign up' as button_label %}
                            {% tpl_button button_label class='is-success' %}
                        </form>
                    {% else %}
                        <h2>{% trans 'Your last trails' %}</h2>
                        <ul class="o-flex has-gutter is-multiline">
                            {% for trail in last_user_trails %}
                                {% url 'trail' trail.id as trail_url %}
                                {% tpl_trail_preview trail trail_url %}
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    <div class="o-section">
        <div class="o-group is-large">
            <h2>{% trans 'Last trails' %}</h2>
            <ul class="o-flex has-gutter is-multiline">
                {% for trail in last_trails %}
                    {% url 'trail' trail.id as trail_url %}
                    {% tpl_trail_preview trail trail_url '1of3' %}
                {% endfor %}
            </ul>
        </div>
    </div>
{% endblock %}
